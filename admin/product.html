<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Qu·∫£n L√Ω S·∫£n Ph·∫©m & Nh·∫≠p H√†ng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        :root{
            --brand-gold: #E6BE8A;
            --brand-crimson: #8B0000;
            --bg-cream: #FFF8E7;
            --muted-brown: #5D4037;
            --card-white: #ffffff;
            --accent-shadow: rgba(139,0,0,0.12);
        }
        
        *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif}
        html,body{height:100%}
        body{
            background: linear-gradient(180deg, var(--bg-cream) 0%, #FFF8F0 100%);
            color: var(--brand-crimson);
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }

        .sidebar{
            width:280px;position:fixed;top:0;left:0;height:100vh;
            background: linear-gradient(135deg, var(--brand-gold) 0%, #D9A86B 100%);
            color: rgba(255,255,255,0.95);box-shadow: 0 0.15rem 1.75rem var(--accent-shadow);z-index:1000;overflow:auto;
        }
        .sidebar-header{padding:1.6rem 1rem;text-align:center;border-bottom:1px solid rgba(255,255,255,0.12);}
        .logo-wrap{display:flex;align-items:center;justify-content:center;gap:0.8rem;}
        .logo-img{width:72px;height:72px;border-radius:12px;background: rgba(255,255,255,0.9);padding:8px;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(0,0,0,0.08);}
        .nav-menu{padding:1rem 0;margin-top:8px}
        .nav-title{padding:0 1.4rem;margin-bottom:0.4rem;font-size:0.75rem;text-transform:uppercase;opacity:0.85;color:rgba(255,255,255,0.9);font-weight:700}
        .nav-menu a{display:flex;align-items:center;padding:0.8rem 1.4rem;color:rgba(255,255,255,0.96);text-decoration:none;border-left:3px solid transparent;transition:all .18s}
        .nav-menu a i{width:22px;text-align:center;margin-right:12px;font-size:1.05rem}
        .nav-menu a:hover, .nav-menu a.active{background:rgba(255,255,255,0.12);border-left-color:#fff;color:#fff}
        .nav-menu a span{font-weight:600}
        .main-content{margin-left:280px;padding:2rem;background:transparent;min-height:100vh;}
        .main-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid rgba(93,64,55,0.06)}
        .main-header h1{font-size:2rem;font-weight:800;color:var(--brand-crimson);display:flex;align-items:center;gap:12px}
        .main-header h1 i{color:var(--brand-gold);font-size:1.6rem}
        .header-actions{display:flex;align-items:center;gap:1rem}
        .search-box{position:relative}
        .search-box input{padding:0.64rem 1rem 0.64rem 2.6rem;border-radius:50px;border:1px solid rgba(0,0,0,0.06);width:250px;background:var(--card-white);color:var(--brand-crimson)}
        .search-box i{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted-brown)}
        .user-info{display:flex;align-items:center;gap:10px;padding:0.45rem 0.8rem;background:var(--card-white);border-radius:50px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
        .user-details .user-name{font-weight:700;color:var(--brand-crimson)}
        .user-role{font-size:0.78rem;color:var(--muted-brown)}
        .logout-btn {background-color: var(--brand-crimson);color: white;border: none;padding: 8px 15px;border-radius: 20px;cursor: pointer;font-weight: 500;margin-left: 15px;transition: background-color 0.3s;}
        .logout-btn:hover {background-color: #6a0000;}
        .footer{text-align:center;padding:1.4rem;color:var(--muted-brown);font-size:0.88rem;border-top:1px solid rgba(93,64,55,0.06);margin-top:1.6rem}

        /* Card v√† table styles */
        .card {background:var(--card-white);border-radius:12px;padding:1.5rem;border-top:4px solid var(--brand-gold);box-shadow:0 10px 30px rgba(92,64,55,0.06);margin-bottom:1.6rem;}
        .card-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:0.6rem;border-bottom:1px solid rgba(93,64,55,0.06)}
        .card-header h2{font-size:1.5rem;font-weight:800;color:var(--brand-crimson);display:flex;align-items:center;gap:10px}
        .card-header h2 i{color:var(--brand-gold)}

        .btn-primary {
            background-color: var(--brand-crimson);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary:hover {
            background-color: #6a0000;
        }

        .btn-add {
            background: #4CAF50;
        }
        
        .btn-add:hover {
            background: #388E3C;
        }

        table{width:100%;border-collapse:collapse;font-size:0.95rem}
        table th, table td{padding:0.8rem;text-align:left;border-bottom:1px solid rgba(93,64,55,0.06)}
        table th{font-weight:800;color:var(--muted-brown);font-size:0.78rem;text-transform:uppercase;background:rgba(230,190,138,0.1)}

        .action-group{display:flex;gap:5px}
        .action-group button{padding:6px 10px;border:1px solid #ccc;border-radius:6px;cursor:pointer;font-size:0.9rem;font-weight:600;transition:all 0.2s;display:inline-flex;align-items:center;gap:5px}

        .btn-edit{background:#FFC107;color:#5D4037;border-color:#FFC107}
        .btn-edit:hover{background:#e0a800;border-color:#e0a800}
        .btn-hide{background:#FFEBEE;color:var(--brand-crimson);border-color:var(--brand-crimson)}
        .btn-hide:hover{background:#f8d7da}
        .btn-show{background:#E8F5E9;color:#2E7D32;border-color:#2E7D32}
        .btn-show:hover{background:#d4edda}
        .btn-delete{background:#D32F2F;color:#fff;border-color:#D32F2F}
        .btn-delete:hover{background:#c62828;border-color:#c62828}

        /* CH·ªàNH S·ª¨A: Ch·ªâ c√≤n 2 tr·∫°ng th√°i t·ªìn kho */
        .status{padding:0.35rem 0.7rem;border-radius:50px;font-weight:700;font-size:0.78rem}
        .status.in-stock{background:#E8F5E9;color:#2E7D32}
        .status.out-of-stock{background:#FFEBEE;color:#C62828}
        .status.low-stock{background:#FFF3E0;color:#EF6C00}
        .status.hidden{background:#9E9E9E;color:#fff}
        .status-draft{background:#FFF3E0;color:#EF6C00;padding:0.35rem 0.7rem;border-radius:50px;font-weight:700;font-size:0.78rem}
        .status-completed{background:#E8F5E9;color:#2E7D32;padding:0.35rem 0.7rem;border-radius:50px;font-weight:700;font-size:0.78rem}

        /* Modal styles */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1001; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            overflow: auto;
            background-color: rgba(0,0,0,0.4); 
            justify-content: center; 
            align-items: center;
        }
        .modal-content {
            background-color: var(--card-white); 
            margin: auto; 
            padding: 30px; 
            border-radius: 12px;
            width: 90%; 
            max-width: 800px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            color: var(--brand-crimson);
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid rgba(93,64,55,0.06)}
        .modal-header h3{font-size:1.5rem;font-weight:800;color:var(--brand-crimson);margin:0}
        .close-btn{font-size:1.5rem;cursor:pointer;color:var(--muted-brown)}
        
        /* Form styles */
        .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}
        .form-group{margin-bottom:1rem}
        .form-group label{display:block;margin-bottom:0.4rem;font-weight:600;color:var(--muted-brown)}
        .form-group input, .form-group select, .form-group textarea{width:100%;padding:0.6rem 1rem;border:1px solid rgba(0,0,0,0.1);border-radius:8px;font-size:1rem}
        .form-group.full-width{grid-column:1/-1}
        .modal-buttons{display:flex;justify-content:flex-end;gap:10px;margin-top:20px}
        
        /* Import styles */
        .import-section{margin-bottom:1.5rem;padding:1rem;background:#f8f9fa;border-radius:8px}
        .search-product{display:flex;gap:10px;margin-bottom:1rem}
        .search-product input{flex:1}
        .product-list{max-height:200px;overflow-y:auto;border:1px solid #ddd;border-radius:8px;padding:0.5rem}
        .product-item{padding:0.5rem;border-bottom:1px solid #eee;cursor:pointer}
        .product-item:hover{background:#e9ecef}
        .product-item.selected{background:var(--brand-gold);color:var(--brand-crimson)}
        .import-table{width:100%;border-collapse:collapse;margin-top:1rem}
        .import-table th, .import-table td{padding:0.8rem;text-align:left;border-bottom:1px solid #ddd}
        .import-table th{background:rgba(230,190,138,0.2)}
        .quantity-input{width:80px;padding:0.3rem;text-align:center}

        /* Category management styles */
        .category-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .category-stat-card {
            background: var(--card-white);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--brand-gold);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            flex: 1;
            min-width: 200px;
        }
        .category-stat-card h4 {
            color: var(--muted-brown);
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .category-stat-card .count {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--brand-crimson);
        }
        .category-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        @media(max-width:768px){
            .sidebar{width:72px}
            .sidebar .nav-title,.nav-menu a span{display:none}
            .nav-menu a{justify-content:center;padding:1rem 0.5rem}
            .main-content{margin-left:72px;padding:1rem}
            .search-box input{width:160px}
            .form-grid{grid-template-columns:1fr}
            .category-stats{flex-direction:column}
        }
        @media(max-width:576px){
            .search-box{display:none}
            .user-details{display:none}
        }
    </style>
</head>
<body>
   <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo-wrap">
                <div class="logo-img">
                    <i class="fas fa-moon" style="font-size: 2rem; color: var(--brand-crimson);"></i>
                </div>
                <div style="display:flex;flex-direction:column;align-items:flex-start">
                    <div style="font-weight:800;color:#fff;font-size:1rem">MORICO</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.92)">B√°nh Trung Thu</div>
                </div>
            </div>
        </div>
        <nav class="nav-menu">
            <div class="nav-section">
                <div class="nav-title">B·∫£ng ƒëi·ªÅu khi·ªÉn</div>
                <a href="dashboard.html"><i class="fas fa-home"></i><span>Trang ch·ªß</span></a>
            </div>
            <div class="nav-section">
                <div class="nav-title">Qu·∫£n l√Ω</div>
                <a href="users.html"><i class="fas fa-users"></i><span>Ng∆∞·ªùi d√πng</span></a>
                <a href="categories.html"><i class="fas fa-tags"></i><span>Lo·∫°i s·∫£n ph·∫©m</span></a>
                <a href="products.html" class="active"><i class="fas fa-box"></i><span>S·∫£n ph·∫©m</span></a>
                <a href="purchase-orders.html"><i class="fas fa-truck-loading"></i><span>Nh·∫≠p h√†ng</span></a>
                <a href="pricing.html"><i class="fas fa-dollar-sign"></i><span>Qu·∫£n l√Ω gi√°</span></a>
                <a href="orders.html"><i class="fas fa-shopping-cart"></i><span>ƒê∆°n h√†ng</span></a>
                <a href="inventory.html"><i class="fas fa-warehouse"></i><span>T·ªìn kho</span></a>
            </div>
        </nav>
    </aside>

    <main class="main-content">
        <div class="main-header">
            <h1><i class="fas fa-box"></i> Qu·∫£n l√Ω Danh M·ª•c S·∫£n Ph·∫©m</h1>
            <div class="header-actions">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user" style="font-size: 1.2rem; color: var(--brand-crimson);"></i>
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="header-username">Ng∆∞·ªùi d√πng</div>
                        <div class="user-role" id="header-role">Qu·∫£n l√Ω</div>
                    </div>
                    <button class="logout-btn" id="logout-btn">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>
        </div>

        <!-- Qu·∫£n l√Ω Lo·∫°i s·∫£n ph·∫©m -->
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-tags"></i> Qu·∫£n l√Ω Lo·∫°i s·∫£n ph·∫©m</h2>
            </div>
            <div class="category-stats" id="category-stats">
                <!-- S·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t b·∫±ng JavaScript -->
            </div>
        </div>

        <!-- Qu·∫£n l√Ω S·∫£n ph·∫©m -->
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-box"></i> Qu·∫£n l√Ω S·∫£n ph·∫©m</h2>
                <button class="btn-primary btn-add" onclick="openProductModal()">
                    <i class="fas fa-plus"></i> Th√™m S·∫£n ph·∫©m
                </button>
            </div>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>M√£ SP</th>
                            <th>T√™n S·∫£n ph·∫©m</th>
                            <th>Lo·∫°i</th>
                            <th>Gi√° b√°n</th>
                            <th>T·ªìn kho</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>H√†nh ƒë·ªông</th>
                        </tr>
                    </thead>
                    <tbody id="product-table-body">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Qu·∫£n l√Ω Nh·∫≠p h√†ng (ƒë√£ b·ªã x√≥a) -->

        <div class="footer">
            <p>¬© 2023 H·ªá th·ªëng Qu·∫£n l√Ω B√°nh Trung Thu MORICO | Phi√™n b·∫£n 2.1.0</p>
        </div>
    </main>

    <!-- Modal S·∫£n ph·∫©m -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title"><i class="fas fa-box"></i> Th√™m S·∫£n ph·∫©m</h3>
                <span class="close-btn" onclick="closeProductModal()">&times;</span>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label>M√£ s·∫£n ph·∫©m:</label>
                    <input type="text" id="product-code" placeholder="SP001">
                </div>
                <div class="form-group">
                    <label>T√™n s·∫£n ph·∫©m:</label>
                    <input type="text" id="product-name" placeholder="B√°nh Trung Thu Nh√¢n H·∫°t Sen">
                </div>
                <div class="form-group">
                    <label>Lo·∫°i:</label>
                    <select id="product-category">
                        <option value="ngot">B√°nh Ng·ªçt</option>
                        <option value="man">B√°nh M·∫∑n</option>
                        <option value="chay">B√°nh Chay</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Gi√° nh·∫≠p (gi√° v·ªën):</label>
                    <input type="number" id="product-cost" placeholder="150000" onchange="calculatePrice()">
                </div>
                <div class="form-group">
                    <label>% L·ª£i nhu·∫≠n:</label>
                    <input type="number" id="product-profit-margin" placeholder="40" min="0" max="200" step="0.5" onchange="calculatePrice()">
                </div>
                <div class="form-group">
                    <label>Gi√° b√°n (t·ª± ƒë·ªông t√≠nh):</label>
                    <input type="number" id="product-price" placeholder="250000" readonly style="background-color: #f5f5f5;">
                </div>
                <div class="form-group">
                    <label>T·ªìn kho:</label>
                    <input type="number" id="product-stock" placeholder="100">
                </div>
                <div class="form-group">
                    <label>Tr·∫°ng th√°i t·ªìn kho:</label>
                    <select id="product-stock-status">
                        <option value="in-stock">C√≤n h√†ng</option>
                        <option value="low-stock">S·∫Øp h·∫øt</option>
                        <option value="out-of-stock">H·∫øt h√†ng</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Tr·∫°ng th√°i hi·ªÉn th·ªã:</label>
                    <select id="product-status">
                        <option value="active">ƒêang b√°n</option>
                        <option value="hidden">ƒê√£ ·∫©n</option>
                    </select>
                </div>
                <div class="form-group full-width">
                    <label>M√¥ t·∫£:</label>
                    <textarea id="product-desc" rows="3" placeholder="M√¥ t·∫£ s·∫£n ph·∫©m..."></textarea>
                </div>
                <div class="form-group full-width">
                    <label>H√¨nh ·∫£nh URL:</label>
                    <input type="text" id="product-image" placeholder="../assets/image/product/banh-trung-thu-golden-plum.png">
                </div>
            </div>
            <div class="modal-buttons">
                <button class="btn-primary" style="background:#6c757d" onclick="closeProductModal()">H·ªßy</button>
                <button class="btn-primary" onclick="saveProduct()">L∆∞u S·∫£n ph·∫©m</button>
            </div>
        </div>
    </div>

    <!-- Import modal removed -->

    <script>
        // ==========================
        // üì¶ DANH S√ÅCH S·∫¢N PH·∫®M (ƒë√£ b·ªï sung tr∆∞·ªùng `stock`)
        // ==========================
        let products = JSON.parse(localStorage.getItem('morico_products')) || [
          {
            id: 1,
            code: "SP001",
            name: "B√°nh Trung Thu Golden Plum",
            price: 189000,
            cost: 120000,
            thumbnail: "../assets/image/product/banh-trung-thu-golden-plum.png",
            category: "ngot",
            stock: 25,
            stockStatus: "in-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n ng·ªçt",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "M·∫≠n v√†ng cao c·∫•p, b·ªôt m√¨, b∆°, tr·ª©ng g√†, ƒë∆∞·ªùng...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p>Tinh t·∫ø v√† m·ªõi m·∫ª, <strong>b√°nh Trung Thu Golden Plum</strong> l√† s·ª± k·∫øt h·ª£p h√†i h√≤a gi·ªØa v·ªã ng·ªçt c·ªßa m·∫≠n v√†ng v√† l·ªõp v·ªè b√°nh n∆∞·ªõng th∆°m m·ªÅm. L·ªõp v·ªè b√°nh v√†ng √≥ng, m·ªÅm m·ªãn √¥m tr·ªçn ph·∫ßn nh√¢n m·∫≠n d·∫ªo th∆°m, mang ƒë·∫øn tr·∫£i nghi·ªám v·ªã gi√°c quen m√† l·∫°.</p>`
          },
          {
            id: 2,
            code: "SP002",
            name: "B√°nh Trung Thu Hotate XO Mixed Nuts",
            price: 139000,
            cost: 90000,
            thumbnail: "../assets/image/product/banh-trung-thu-hotate-xo-mixed-nuts.png",
            category: "man",
            stock: 12,
            stockStatus: "low-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n m·∫∑n",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "S√≤ ƒëi·ªáp XO, c√°c lo·∫°i h·∫°t (h·∫°t ƒëi·ªÅu, h·∫°t d∆∞a...), l·∫°p x∆∞·ªüng...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p>M·ªôt s·ª± ph√° c√°ch ƒë·ªôc ƒë√°o cho m√πa Trung Thu, <strong>b√°nh Hotate XO Mixed Nuts</strong> k·∫øt h·ª£p v·ªã m·∫∑n ƒë·∫≠m ƒë√† c·ªßa s·ªët s√≤ ƒëi·ªáp XO cay nh·∫π c√πng s·ª± b√πi b√©o c·ªßa c√°c lo·∫°i h·∫°t dinh d∆∞·ª°ng. ƒê√¢y l√† l·ª±a ch·ªçn ho√†n h·∫£o cho nh·ªØng ai t√¨m ki·∫øm h∆∞∆°ng v·ªã m·ªõi l·∫°.</p>`
          },
          {
            id: 3,
            code: "SP003",
            name: "B√°nh Trung Thu Matcha",
            price: 99000,
            cost: 65000,
            thumbnail: "../assets/image/product/banh-trung-thu-matcha.png",
            category: "ngot",
            stock: 40,
            stockStatus: "in-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n tr√† xanh",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "B·ªôt matcha, b·ªôt m√¨, tr·ª©ng, b∆°, ƒë·∫≠u xanh, ƒë∆∞·ªùng...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu Matcha</strong> mang ƒë·∫≠m h∆∞∆°ng v·ªã thanh m√°t c·ªßa tr√† xanh Nh·∫≠t B·∫£n. H∆∞∆°ng th∆°m nh·∫π, v·ªã ng·ªçt d·ªãu, c√πng l·ªõp nh√¢n ƒë·∫≠u xanh h√≤a quy·ªán matcha tinh t·∫ø, t·∫°o n√™n c·∫£m gi√°c nh·∫π nh√†ng v√† th∆∞ gi√£n.</p>`
          },
          {
            id: 4,
            code: "SP004",
            name: "B√°nh Trung Thu Murasaki Imo",
            price: 115000,
            cost: 75000,
            thumbnail: "../assets/image/product/banh-trung-thu-murasaki-imo.png",
            category: "ngot",
            stock: 30,
            stockStatus: "in-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n ng·ªçt",
              "Th√†nh ph·∫ßn": "Khoai lang t√≠m Nh·∫≠t, b·ªôt m√¨, ƒë∆∞·ªùng, tr·ª©ng, b∆°...",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu Murasaki Imo</strong> mang s·∫Øc t√≠m d·ªãu d√†ng c·ªßa khoai lang Nh·∫≠t B·∫£n. Nh√¢n khoai d·∫ªo m·ªãn, th∆°m nh·∫π v·ªã ng·ªçt t·ª± nhi√™n, h√≤a quy·ªán c√πng l·ªõp v·ªè b√°nh m·ªÅm v√†ng h·∫•p d·∫´n.</p>`
          },
          {
            id: 5,
            code: "SP005",
            name: "B√°nh Trung Thu Mushroom Mixed Nuts",
            price: 129000,
            cost: 85000,
            thumbnail: "../assets/image/product/banh-trung-thu-mushroom-mixed-nuts.png",
            category: "chay",
            stock: 18,
            stockStatus: "low-stock",
            stockStatus: "in-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh chay ‚Äì nh√¢n m·∫∑n nh·∫π",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "N·∫•m h∆∞∆°ng, h·∫°t ƒëi·ªÅu, h·∫°t sen, ƒë·∫≠u xanh, b·ªôt m√¨...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu Mushroom Mixed Nuts</strong> l√† l·ª±a ch·ªçn thanh ƒë·∫°m v√† dinh d∆∞·ª°ng cho ng∆∞·ªùi ƒÉn chay. H∆∞∆°ng th∆°m c·ªßa n·∫•m h√≤a quy·ªán c√πng v·ªã b√πi b√©o c·ªßa c√°c lo·∫°i h·∫°t, t·∫°o n√™n h∆∞∆°ng v·ªã t·ª± nhi√™n, nh·∫π nh√†ng.</p>`
          },
          {
            id: 6,
            code: "SP006",
            name: "B√°nh Trung Thu H·∫°t Sen D·ª´a Non",
            price: 105000,
            cost: 70000,
            thumbnail: "../assets/image/product/banh-trung-thu-pink-nocturne.png",
            category: "ngot",
            stock: 50,
            stockStatus: "in-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n ng·ªçt",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "H·∫°t sen, d·ª´a non, b·ªôt m√¨, tr·ª©ng, b∆°, ƒë∆∞·ªùng...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu H·∫°t Sen D·ª´a Non</strong> mang v·ªã ng·ªçt thanh, b√πi b√©o c·ªßa h·∫°t sen h√≤a c√πng m√πi th∆°m nh·∫π c·ªßa d·ª´a non, t·∫°o c·∫£m gi√°c m·ªÅm m·ªãn d·ªÖ ch·ªãu.</p>`
          },
          {
            id: 7,
            code: "SP007",
            name: "B√°nh Trung Thu ƒê·∫≠u ƒê·ªè Tr·ª©ng Mu·ªëi",
            price: 125000,
            cost: 80000,
            thumbnail: "../assets/image/product/banh-trung-thu-takesumi-orange.png",
            category: "man",
            stock: 0,
            stockStatus: "out-of-stock",
            status: "active",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh n∆∞·ªõng ‚Äì nh√¢n m·∫∑n",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "ƒê·∫≠u ƒë·ªè, tr·ª©ng mu·ªëi, b·ªôt m√¨, ƒë∆∞·ªùng, d·∫ßu th·ª±c v·∫≠t...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu ƒê·∫≠u ƒê·ªè Tr·ª©ng Mu·ªëi</strong> c√≥ v·ªã m·∫∑n ng·ªçt h√†i h√≤a, nh√¢n ƒë·∫≠u ƒë·ªè b√πi quy·ªán c√πng tr·ª©ng mu·ªëi tan ch·∫£y, mang l·∫°i c·∫£m gi√°c tr·ªçn v·ªã truy·ªÅn th·ªëng v√† hi·ªán ƒë·∫°i.</p>`
          },
          {
            id: 8,
            code: "SP008",
            name: "B√°nh Trung Thu X√¥i G·∫•c",
            price: 95000,
            cost: 60000,
            thumbnail: "../assets/image/product/banh-trung-thu-xoi-gac.png",
            category: "ngot",
            stock: 35,
            stockStatus: "in-stock",
            status: "hidden",
            details: {
              "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
              "Lo·∫°i b√°nh": "B√°nh d·∫ªo ‚Äì nh√¢n ng·ªçt",
              "Tr·ªçng l∆∞·ª£ng": "150g",
              "Th√†nh ph·∫ßn": "G·∫°o n·∫øp, g·∫•c t∆∞∆°i, nh√¢n ƒë·∫≠u xanh, d·ª´a n·∫°o...",
              "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
            },
            description: `<p><strong>B√°nh Trung Thu X√¥i G·∫•c</strong> c√≥ m√†u ƒë·ªè t·ª± nhi√™n t·ª´ g·∫•c, t∆∞·ª£ng tr∆∞ng cho may m·∫Øn v√† h·∫°nh ph√∫c. H∆∞∆°ng th∆°m c·ªßa n·∫øp quy·ªán c√πng v·ªã ng·ªçt nh·∫π c·ªßa ƒë·∫≠u xanh v√† d·ª´a, mang ƒë·∫øn c·∫£m gi√°c truy·ªÅn th·ªëng th√¢n quen.</p>`
          }
        ];

        let currentEditingId = null;

        // ƒê·ªãnh nghƒ©a c√°c lo·∫°i s·∫£n ph·∫©m
        const categories = [
            { id: 'ngot', name: 'B√°nh Ng·ªçt', status: 'active' },
            { id: 'man', name: 'B√°nh M·∫∑n', status: 'active' },
            { id: 'chay', name: 'B√°nh Chay', status: 'active' }
        ];

        // L∆∞u d·ªØ li·ªáu v√†o localStorage
        function saveDataToStorage() {
            localStorage.setItem('morico_products', JSON.stringify(products));
            localStorage.setItem('morico_categories', JSON.stringify(categories));
        }

        // Kh·ªüi t·∫°o d·ªØ li·ªáu m·∫´u l·∫ßn ƒë·∫ßu n·∫øu localStorage tr·ªëng
        function initializeSampleData() {
            const existingData = localStorage.getItem('morico_products');
            
            // Ki·ªÉm tra n·∫øu ch∆∞a c√≥ data HO·∫∂C data l√† empty array
            if (!existingData || JSON.parse(existingData).length === 0) {
                console.log('üöÄ Kh·ªüi t·∫°o d·ªØ li·ªáu m·∫´u l·∫ßn ƒë·∫ßu...');
                saveDataToStorage();
                // Reload l·∫°i products t·ª´ localStorage sau khi save
                products = JSON.parse(localStorage.getItem('morico_products')) || products;
                console.log('‚úÖ ƒê√£ kh·ªüi t·∫°o ' + products.length + ' s·∫£n ph·∫©m');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Kh·ªüi t·∫°o d·ªØ li·ªáu m·∫´u l·∫ßn ƒë·∫ßu
            initializeSampleData();

            // C·∫≠p nh·∫≠t t√™n ng∆∞·ªùi d√πng (n·∫øu c√≥ ƒëƒÉng nh·∫≠p)
            const currentUser = localStorage.getItem('loggedInUser');
            if (currentUser) {
                updateUserDisplay(currentUser);
            }

            // X·ª≠ l√Ω ƒëƒÉng xu·∫•t
            document.getElementById('logout-btn').addEventListener('click', function() {
                localStorage.removeItem('loggedInUser');
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminUsername');
                window.location.href = 'index.html';
            });

            // Hi·ªÉn th·ªã d·ªØ li·ªáu
            renderCategoryStats();
            renderProducts();

            // T√¨m ki·∫øm s·∫£n ph·∫©m
            document.getElementById('admin-search').addEventListener('input', function() {
                searchProductsAdmin(this.value);
            });
        });
        function updateUserDisplay(username) {
            document.getElementById('header-username').textContent = username;
            
            let role = 'Nh√¢n vi√™n';
            if (username === 'admin') role = 'Qu·∫£n tr·ªã vi√™n';
            else if (username === 'staff') role = 'Nh√¢n vi√™n b√°n h√†ng';
            
            document.getElementById('header-role').textContent = role;
        }
        // Hi·ªÉn th·ªã th·ªëng k√™ lo·∫°i s·∫£n ph·∫©m
        function renderCategoryStats() {
            const container = document.getElementById('category-stats');
            container.innerHTML = '';

            categories.forEach(category => {
                const categoryProducts = products.filter(p => p.category === category.id);
                const activeProducts = categoryProducts.filter(p => p.status === 'active');
                const hiddenProducts = categoryProducts.filter(p => p.status === 'hidden');
                
                const statCard = document.createElement('div');
                statCard.className = 'category-stat-card';
                statCard.innerHTML = `
                    <h4>${category.name}</h4>
                    <div class="count">${categoryProducts.length} s·∫£n ph·∫©m</div>
                    <div style="font-size: 0.8rem; color: #666; margin-top: 5px;">
                        <span style="color: #4CAF50;">${activeProducts.length} ƒëang b√°n</span> | 
                        <span style="color: #9E9E9E;">${hiddenProducts.length} ƒë√£ ·∫©n</span>
                    </div>
                    <div class="category-actions">
                        <button class="btn-${category.status === 'active' ? 'hide' : 'show'}" 
                                onclick="toggleCategoryStatus('${category.id}')"
                                style="padding: 4px 8px; font-size: 0.8rem;">
                            <i class="fas fa-${category.status === 'active' ? 'eye-slash' : 'eye'}"></i> 
                            ${category.status === 'active' ? '·∫®n t·∫•t c·∫£' : 'Hi·ªán t·∫•t c·∫£'}
                        </button>
                        <button class="btn-edit" onclick="viewCategoryProducts('${category.id}')"
                                style="padding: 4px 8px; font-size: 0.8rem;">
                            <i class="fas fa-list"></i> Xem
                        </button>
                    </div>
                `;
                container.appendChild(statCard);
            });
        }

        // ·∫®n/hi·ªán to√†n b·ªô s·∫£n ph·∫©m theo lo·∫°i
        function toggleCategoryStatus(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return;

            const newStatus = category.status === 'active' ? 'hidden' : 'active';
            const actionText = newStatus === 'active' ? 'hi·ªán' : '·∫©n';
            
            if (confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën ${actionText} to√†n b·ªô s·∫£n ph·∫©m ${category.name}?`)) {
                // C·∫≠p nh·∫≠t tr·∫°ng th√°i lo·∫°i
                category.status = newStatus;
                
                // C·∫≠p nh·∫≠t t·∫•t c·∫£ s·∫£n ph·∫©m thu·ªôc lo·∫°i n√†y
                products.forEach(product => {
                    if (product.category === categoryId) {
                        product.status = newStatus;
                    }
                });

                saveDataToStorage();
                renderCategoryStats();
                renderProducts();
                alert(`ƒê√£ ${actionText} to√†n b·ªô s·∫£n ph·∫©m ${category.name}!`);
            }
        }

        // Xem s·∫£n ph·∫©m theo lo·∫°i
        function viewCategoryProducts(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return;

            const categoryProducts = products.filter(p => p.category === categoryId);
            renderProducts(categoryProducts);
            
            // Hi·ªÉn th·ªã th√¥ng b√°o
            const searchInput = document.getElementById('admin-search');
            searchInput.value = '';
            searchInput.placeholder = `ƒêang xem ${category.name} (${categoryProducts.length} s·∫£n ph·∫©m)`;
        }

        // T√¨m ki·∫øm s·∫£n ph·∫©m trong admin
        function searchProductsAdmin(searchTerm) {
            if (!searchTerm.trim()) {
                renderProducts();
                document.getElementById('admin-search').placeholder = 'T√¨m ki·∫øm...';
                return;
            }

            const normalizedSearchTerm = searchTerm.toLowerCase().trim();
            const searchResults = products.filter(product => {
                return product.name.toLowerCase().includes(normalizedSearchTerm) || 
                       product.code.toLowerCase().includes(normalizedSearchTerm);
            });

            renderProducts(searchResults);
        }

        // ===== QU·∫¢N L√ù S·∫¢N PH·∫®M =====
        function renderProducts(productList = products) {
            const tbody = document.getElementById('product-table-body');
            tbody.innerHTML = '';

            productList.forEach(product => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${product.code}</td>
                    <td><strong>${product.name}</strong></td>
                    <td>${getCategoryText(product.category)}</td>
                    <td>${product.price.toLocaleString()} VNƒê</td>
                    <td>${product.stock}</td>
                    <td><span class="status ${getStatusClass(product)}">${getProductStatusText(product)}</span></td>
                    <td class="action-group">
                        <button class="btn-edit" onclick="editProduct(${product.id})"><i class="fas fa-edit"></i> S·ª≠a</button>
                        <button class="btn-${product.status === 'active' ? 'hide' : 'show'}" onclick="toggleProductStatus(${product.id})">
                            <i class="fas fa-${product.status === 'active' ? 'eye-slash' : 'eye'}"></i> ${product.status === 'active' ? '·∫®n' : 'Hi·ªán'}
                        </button>
                        <button class="btn-delete" onclick="deleteProduct(${product.id})"><i class="fas fa-trash-alt"></i> X√≥a</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function getCategoryText(category) {
            switch(category) {
                case 'ngot': return 'B√°nh Ng·ªçt';
                case 'man': return 'B√°nh M·∫∑n';
                case 'chay': return 'B√°nh Chay';
                default: return category;
            }
        }

        function getStatusClass(product) {
            if (product.status === 'hidden') return 'hidden';
            return product.stockStatus;
        }

        function getProductStatusText(product) {
            if (product.status === 'hidden') return 'ƒê√£ ·∫©n';
            
            switch(product.stockStatus) {
                case 'in-stock': return 'C√≤n h√†ng';
                case 'low-stock': return 'S·∫Øp h·∫øt';
                case 'out-of-stock': return 'H·∫øt h√†ng';
                default: return 'N/A';
            }
        }

        function calculatePrice() {
            const cost = parseFloat(document.getElementById('product-cost').value) || 0;
            const profitMargin = parseFloat(document.getElementById('product-profit-margin').value) || 0;
            const price = Math.round(cost * (1 + profitMargin / 100));
            document.getElementById('product-price').value = price;
        }

        function openProductModal() {
            currentEditingId = null;
            document.getElementById('product-modal-title').innerHTML = '<i class="fas fa-box"></i> Th√™m S·∫£n ph·∫©m';
            document.getElementById('product-modal').style.display = 'flex';
            // Reset form
            document.getElementById('product-code').value = '';
            document.getElementById('product-name').value = '';
            document.getElementById('product-category').value = 'ngot';
            document.getElementById('product-cost').value = '';
            document.getElementById('product-profit-margin').value = '40';
            document.getElementById('product-price').value = '';
            document.getElementById('product-stock').value = '';
            document.getElementById('product-stock-status').value = 'in-stock';
            document.getElementById('product-status').value = 'active';
            document.getElementById('product-desc').value = '';
            document.getElementById('product-image').value = '';
        }

        function closeProductModal() {
            document.getElementById('product-modal').style.display = 'none';
        }

        function saveProduct() {
            const code = document.getElementById('product-code').value;
            const name = document.getElementById('product-name').value;
            const category = document.getElementById('product-category').value;
            const cost = parseFloat(document.getElementById('product-cost').value);
            const profitMargin = parseFloat(document.getElementById('product-profit-margin').value) || 0;
            const price = parseFloat(document.getElementById('product-price').value);
            const stock = parseInt(document.getElementById('product-stock').value) || 0;
            const stockStatus = document.getElementById('product-stock-status').value;
            const status = document.getElementById('product-status').value;
            const description = document.getElementById('product-desc').value;
            const thumbnail = document.getElementById('product-image').value;

            if (!code || !name || !category) {
                alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!');
                return;
            }

            // T·ª∞ ƒê·ªòNG C·∫¨P NH·∫¨T TR·∫†NG TH√ÅI T·ªíN KHO (3 tr·∫°ng th√°i)
            let autoStockStatus;
            if (stock === 0) {
                autoStockStatus = 'out-of-stock';
            } else if (stock <= 20) {
                autoStockStatus = 'low-stock';
            } else {
                autoStockStatus = 'in-stock';
            }

            const productData = {
                code, name, category, cost, price, stock, 
                profitMargin, // Th√™m % l·ª£i nhu·∫≠n
                stockStatus: autoStockStatus, // S·ª≠ d·ª•ng tr·∫°ng th√°i t·ª± ƒë·ªông
                status, 
                description, thumbnail,
                details: {
                    "Th∆∞∆°ng hi·ªáu": "Mor'dan Bakery",
                    "Lo·∫°i b√°nh": category === 'ngot' ? 'B√°nh n∆∞·ªõng ‚Äì nh√¢n ng·ªçt' : 
                                 category === 'man' ? 'B√°nh n∆∞·ªõng ‚Äì nh√¢n m·∫∑n' : 'B√°nh chay',
                    "Tr·ªçng l∆∞·ª£ng": "150g",
                    "Th√†nh ph·∫ßn": "Th√†nh ph·∫ßn cao c·∫•p...",
                    "H·∫°n s·ª≠ d·ª•ng": "Xem tr√™n bao b√¨ s·∫£n ph·∫©m"
                }
            };

            if (currentEditingId) {
                // S·ª≠a s·∫£n ph·∫©m
                const index = products.findIndex(p => p.id === currentEditingId);
                products[index] = { ...products[index], ...productData };
            } else {
                // Th√™m m·ªõi
                const newProduct = {
                    id: products.length + 1,
                    ...productData
                };
                products.push(newProduct);
            }

            saveDataToStorage();
            renderCategoryStats();
            renderProducts();
            closeProductModal();
            alert(currentEditingId ? 'ƒê√£ c·∫≠p nh·∫≠t s·∫£n ph·∫©m!' : 'ƒê√£ th√™m s·∫£n ph·∫©m m·ªõi!');
        }

        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                currentEditingId = id;
                document.getElementById('product-modal-title').innerHTML = '<i class="fas fa-edit"></i> S·ª≠a S·∫£n ph·∫©m';
                document.getElementById('product-code').value = product.code;
                document.getElementById('product-name').value = product.name;
                document.getElementById('product-category').value = product.category;
                document.getElementById('product-cost').value = product.cost;
                document.getElementById('product-profit-margin').value = product.profitMargin || 0;
                document.getElementById('product-price').value = product.price;
                document.getElementById('product-stock').value = product.stock;
                document.getElementById('product-stock-status').value = product.stockStatus;
                document.getElementById('product-status').value = product.status;
                document.getElementById('product-desc').value = product.description || '';
                document.getElementById('product-image').value = product.thumbnail;
                document.getElementById('product-modal').style.display = 'flex';
            }
        }

        function toggleProductStatus(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                product.status = product.status === 'active' ? 'hidden' : 'active';
                saveDataToStorage();
                renderCategoryStats();
                renderProducts();
                alert(`ƒê√£ ${product.status === 'active' ? 'hi·ªán' : '·∫©n'} s·∫£n ph·∫©m!`);
            }
        }

        function deleteProduct(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) {
                products = products.filter(p => p.id !== id);
                saveDataToStorage();
                renderCategoryStats();
                renderProducts();
                alert('ƒê√£ x√≥a s·∫£n ph·∫©m!');
            }
        }

        // Import/order management removed
    </script>
</body>
</html>
</html>